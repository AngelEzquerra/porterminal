<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Terminal">
    <meta name="theme-color" content="#1e1e1e">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Terminal">
    <meta name="msapplication-TileColor" content="#1e1e1e">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="format-detection" content="telephone=no">
    <title>Terminal</title>

    <!-- PWA -->
    <link rel="manifest" href="/static/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/static/icon.svg">
    <link rel="apple-touch-icon" href="/static/icon-192.png">

    <!-- xterm.js with SRI -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css" integrity="sha384-LJcOxlx9IMbNXDqJ2axpfEQKkAYbFjJfhXexLfiRJhjDU81mzgkiQq8rkV0j6dVh" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js" integrity="sha384-xjfWUeCWdMtvpAb/SmM6lMzS6pQGcQa0loOl1d97j6Odw0vjK9nW3+dTb/bn/mwH" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js" integrity="sha384-dpjGwSSISUTz2taP54Bor7qkyMR20sSO9oe11UVYnGs2/YdUBf7HW30XKQx9PCzn" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-webgl@0.16.0/lib/xterm-addon-webgl.min.js" integrity="sha384-LjE7pQ+MvZLxKNFYaNqxXiKIg0LASkwKbvcMtgxwNfSSDVjJ4tgEe0p56hzikjhs" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-web-links@0.9.0/lib/xterm-addon-web-links.min.js" integrity="sha384-iAAiqSZrWZz/YKZSTKOPNaRhVOg9JY14avg2EWEpYNnUsrnATA+Sg8pV7mak84/G" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="app">
        <!-- Tab Bar with Shell Selector -->
        <div id="tab-bar">
            <!-- Tabs rendered by JS -->
            <div id="shell-selector">
                <span id="connection-dot"></span>
                <select id="shell-select"><option>...</option></select>
                <button id="btn-shutdown" title="Shutdown">⏻</button>
            </div>
        </div>

        <!-- Terminal Area -->
        <div id="terminal-container">
            <div id="terminal"></div>
        </div>

        <!-- Bottom Toolbar - Minimal single row -->
        <div id="toolbar">
            <button class="tool-btn modifier" id="btn-ctrl">Ct</button>
            <button class="tool-btn modifier" id="btn-alt">At</button>
            <button class="tool-btn arrow" data-key="ArrowLeft">←</button>
            <button class="tool-btn arrow" data-key="ArrowDown">↓</button>
            <button class="tool-btn arrow" data-key="ArrowUp">↑</button>
            <button class="tool-btn arrow" data-key="ArrowRight">→</button>
            <button class="tool-btn" data-send="&#x1b;[Z">ST</button>
            <button class="tool-btn" data-key="Tab">⇥</button>
            <button class="tool-btn" id="btn-escape">Es</button>
            <button class="tool-btn danger" data-key="Ctrl+C">^C</button>
            <button class="tool-btn" id="btn-paste">⎘</button>
        </div>

    </div>

    <!-- Connection Lost Overlay -->
    <div id="disconnect-overlay" class="hidden">
        <div id="disconnect-content">
            <div id="disconnect-icon">○</div>
            <div id="disconnect-text">Connection Lost</div>
            <button id="disconnect-retry">Retry</button>
        </div>
    </div>

    <script src="/static/app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/static/sw.js')
                .catch((e) => console.warn('SW registration failed:', e));
        }
    </script>
</body>
</html>
